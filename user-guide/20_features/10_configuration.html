<!doctype html>
<html lang="en">
<head>
    
    <!-- sourceuri: user-guide/20_features/10_configuration.html -->
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
    <meta content="INDEX, FOLLOW" name="ROBOTS">

    <title>Configuration</title>

    <meta content="Pillars" property="og:title">
    <meta content="Build your backend service in Scala 3 the easy way" property="og:description">
    <meta content="website" property="og:type">
    <meta content="Pillars" property="og:site_name">
    <meta content="Pillars" itemprop="name">
    <meta content="Build your backend service in Scala 3 the easy way" itemprop="description">
    <meta content="summary" name="twitter:card">
    <meta content="@rlemaitre" name="twitter:creator">
    <meta content="Pillars" name="twitter:title">
    <meta content="Build your backend service in Scala 3 the easy way" name="twitter:description">
    <meta property="og:url" content="https://pillars.rlemaitre.com/" />
    <meta property="og:title" content="Pillars" />
    <meta property="og:description" content="Build your backend service in Scala 3 the easy way" />
    <meta property="og:image" content="https://pillars.rlemaitre.com/images/logo.svg" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="../../css/asciidoctor.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <link rel="stylesheet" href="../../css/scribbler-global.css">
    
        <link rel="stylesheet" href="../../css/scribbler-doc.css">
    
    <link rel="author" href="../..//humans.txt">

    <!-- favicon generated with https://www.favicon-generator.org/ -->
    <link rel="icon" type="image/svg+xml" href="../../favicon.svg">
    <link rel="icon" type="image/png" href="../../favicon.png">
    <meta name="theme-color" content="#0a1322">
</head>

<body>

<nav class="header">
    <a href="../../"><img src="../../images/logo_without_name.svg" width="43"></a>
    <h1 class="logo">Pillars <span class="logo__thin">Doc</span></h1>
    <ul class="menu">
        <div class="menu__item toggle"><span></span></div>
        <li class="menu__item"><a href="../../" class="link link--dark"><i class="fa fa-home"></i> Home</a></li>

        <li class="menu__item"><a href="../../user-guide/index.html" class="link link--dark"><i class="fa fa-book"></i> User Guide</a></li>

        <li class="menu__item"><a href="../../contribute/10_contributing.html" class="link link--dark"><i class="fa fa-book"></i> Contribute</a></li>

        <li class="menu__item"><a href="../../api/" class="link link--dark"><i class="fa fa-cogs"></i> API</a></li>
        <li class="menu__item"><a href="https://github.com/rlemaitre/pillars/" class="link link--dark"><i class="fa fa-github"></i> Github</a></li>
        <li class="menu__item">
            <form action="../../search.html">
                <input aria-label="Search this site…" autocomplete="off" class="form-control td-search-input"
                       placeholder="Search this site…" type="search" name="q">
            </form>
        </li>
    </ul>
</nav>

<div class="wrapper">
	<aside class="doc__nav">
		
        
                        <ul>
                            <li>
                                <a class="" href="../../user-guide/index.html">Overview</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/10_quick-start.html">Quick Start</a>
                            </li>
                            <li>
                                Features
                        <ul>
                            <li>
                                <a class="active" href="../../user-guide/20_features/10_configuration.html">Configuration</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/20_features/20_logging.html">Logging</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/20_features/30_probes.html">Probes</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/20_features/40_api-server.html">API Server</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/20_features/50_observability.html">Observability</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/20_features/60_admin-server.html">Admin Server</a>
                            </li>
                        </ul>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/30_modules/index.html">Optional Modules</a>
                        <ul>
                            <li>
                                <a class="" href="../../user-guide/30_modules/10_db.html">Database Module</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/30_modules/20_http-client.html">HTTP Client Module</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/30_modules/30_flags.html">Feature Flags module</a>
                            </li>
                            <li>
                                <a class="" href="../../user-guide/30_modules/100_write-your-own-module.html">Write your own module</a>
                            </li>
                        </ul>
                            </li>
                        </ul>

	</aside>
	<article class="doc__content">
		    <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
        <ol class="breadcrumb spb-1">
            <!--li aria-current="page" class="breadcrumb-item active">
                <a href="https://example.docsy.dev/docs/">Documentation</a>
            </li-->

        </ol>
    </nav>


    <div class="td-content">
        <p>
            
<div class="sect1">
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pillars is configured using <a href="https://yaml.org/spec/1.2.2/">YAML v1.2</a> files.</p>
</div>
<div class="sect2">
<h3 id="_pillars_configuration">Pillars Configuration</h3>
<div class="paragraph">
<p>Pillars configuration is structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">name: Bookstore
log:
  level: info
  format: enhanced
  output:
    type: console
db:
  host: localhost
  port: 5432
  database: bookstore
  username: postgres
  password: postgres
  pool-size: 10
  debug: false
  probe:
    timeout: PT5s
    interval: PT10s
    failure-count: 3
api:
  enabled: true
  http:
    host: 0.0.0.0
    port: 9876
    enable-logging: true
admin:
  enabled: true
  http:
    host: 0.0.0.0
    port: 19876
    enable-logging: true
observability:
  enabled: true
  service-name: bookstore
feature-flags:
  enabled: true
  flags:
    - name: feature-1
      status: enabled
    - name: feature-2
      status: disabled</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using the <code>EntryPoint</code> trait, the path to this file must be given to the application using the <code>--config</code> command line option.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The config <strong>must</strong> contain the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: the name of the application</p>
</li>
<li>
<p><code>api</code>: the API server configuration</p>
</li>
<li>
<p><code>admin</code>: the admin server configuration</p>
</li>
<li>
<p><code>observability</code>: the observability configuration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The logging configuration is optional and can be omitted if you are happy with the default configuration.</p>
</div>
<div class="paragraph">
<p>The <code>db</code> and <code>feature-flags</code> sections are needed only if you include the <code>db</code> and <code>feature-flags</code> modules respectively.</p>
</div>
<div class="sect3">
<h4 id="api-configuration">API Configuration</h4>
<div class="paragraph">
<p>The API configuration is structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">api:
  enabled: true
  http:
    host: 0.0.0.0
    port: 9876
    enable-logging: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>It contains the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: whether the API server is enabled or not</p>
</li>
<li>
<p><code>http</code>: the HTTP server configuration:</p>
<div class="ulist">
<ul>
<li>
<p><code>host</code>: the host to bind to. Default is <code>0.0.0.0</code>, i.e. all interfaces.</p>
</li>
<li>
<p><code>port</code>: the port to bind to. Default is <code>9876</code>.</p>
</li>
<li>
<p><code>enable-logging</code>: whether to enable HTTP access logging or not. Default is <code>false</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="admin-configuration">Admin Configuration</h4>
<div class="paragraph">
<p>The admin configuration is structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">admin:
  enabled: true
  http:
    host: 0.0.0.0
    port: 19876
    enable-logging: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>It contains the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: whether the admin server is enabled or not</p>
</li>
<li>
<p><code>http</code>: the HTTP server configuration:</p>
<div class="ulist">
<ul>
<li>
<p><code>host</code>: the host to bind to. Default is <code>0.0.0.0</code>, i.e. all interfaces.</p>
</li>
<li>
<p><code>port</code>: the port to bind to. Default is <code>19876</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="observability-configuration">Observability Configuration</h4>
<div class="paragraph">
<p>The observability configuration is structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">observability:
  enabled: true
  service-name: bookstore</code></pre>
</div>
</div>
<div class="paragraph">
<p>It contains the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: whether observability is enabled or not</p>
</li>
<li>
<p><code>service-name</code>: the name of the service.Default is <code>pillars</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="logging-configuration">Logging Configuration</h4>
<div class="paragraph">
<p>The logging configuration is structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">log:
  level: info
  format: enhanced
  output:
    type: console</code></pre>
</div>
</div>
<div class="paragraph">
<p>It contains the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>level</code>: the log level.
Possible values are <code>trace</code>, <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code>.
Default is <code>info</code>.</p>
</li>
<li>
<p><code>format</code>: the log format.
Possible values are <code>json</code>, <code>simple</code>, <code>colored</code>, <code>classic</code>, <code>compact</code>, <code>enhanced</code>, <code>advanced</code>, <code>strict</code>.
For more details, refer to the <a href="https://github.com/outr/scribe/wiki">scribe documentation</a>.
Default is <code>enhanced</code>.</p>
</li>
<li>
<p><code>output</code>: the log output.</p>
<div class="ulist">
<ul>
<li>
<p><code>type</code>: the log output type.
Possible values are <code>console</code> or <code>file</code>.
Default is <code>console</code>.</p>
</li>
<li>
<p><code>path</code>: the path to the log file.
It is used only if <code>output.type</code> is <code>file</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="db-configuration">Database Configuration</h4>
<div class="paragraph">
<p>The database configuration is structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">db:
  host: localhost
  port: 5432
  database: bookstore
  username: postgres
  password: postgres
  pool-size: 10
  debug: false
  probe:
    timeout: PT5s
    interval: PT10s
    failure-count: 3</code></pre>
</div>
</div>
<div class="paragraph">
<p>It contains the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>host</code>: the database host. Default is <code>localhost</code>.</p>
</li>
<li>
<p><code>port</code>: the database port. Default is <code>5432</code>.</p>
</li>
<li>
<p><code>database</code>: the database name.</p>
</li>
<li>
<p><code>user</code>: the database user.</p>
</li>
<li>
<p><code>password</code>: the database password.</p>
</li>
<li>
<p><code>pool-size</code>: the database connection pool size. Default is <code>32</code>.</p>
</li>
<li>
<p><code>debug</code>: whether to enable database debug logging or not. Default is <code>false</code>.</p>
</li>
<li>
<p><code>probe</code>: the database probe configuration:</p>
<div class="ulist">
<ul>
<li>
<p><code>timeout</code>: the probe timeout. Default is <code>5s</code>.</p>
</li>
<li>
<p><code>interval</code>: the probe interval. Default is <code>10s</code>.</p>
</li>
<li>
<p><code>failure-count</code>: the number of consecutive failures before the database is considered down. Default is <code>3</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="feature-flags-configuration">Feature Flags Configuration</h4>
<div class="paragraph">
<p>The feature flags configuration is structured as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="yaml">feature-flags:
  enabled: true
  flags:
    - name: feature-1
      status: enabled
    - name: feature-2
      status: disabled</code></pre>
</div>
</div>
<div class="paragraph">
<p>It contains the following keys:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>enabled</code>: whether feature flags are enabled or not</p>
</li>
<li>
<p><code>flags</code>: the feature flags definition:</p>
<div class="ulist">
<ul>
<li>
<p><code>name</code>: the name of the feature flag</p>
</li>
<li>
<p><code>status</code>: the status of the feature flag. Possible values are <code>enabled</code> or <code>disabled</code>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_application_configuration">Application Configuration</h3>
<div class="paragraph">
<p>You can define the configuration of your application in the same file as the Pillars configuration.
It <strong>must</strong> be under the <code>app</code> key.</p>
</div>
<div class="paragraph">
<p>In order to read the configuration, you need to use the <code>configReader</code> method of the <code>Pillars</code> instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="scala">object app extends pillars.EntryPoint:
    def app: pillars.App[IO] = new pillars.App[IO]:
        def infos: AppInfo = BuildInfo.toAppInfo

        def run(using p: Pillars[IO]): IO[Unit] =
            import p.*
            for
                config &lt;- configReader[BookstoreConfig]
                _ &lt;- IO.println(s"Config: $config")
            yield ()</code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration class must be a case class and there must be at least a circe <code>Decoder</code> defined for it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="scala">package example

import io.circe.Codec

case class BookstoreConfig(enabled: Boolean = true, users: UsersConfig = UsersConfig())
object BookstoreConfig:
    given Codec[BookstoreConfig] = Codec.AsObject.derived

case class UsersConfig(init: Boolean = false)
object UsersConfig:
    given Codec[UsersConfig] = Codec.AsObject.derived</code></pre>
</div>
</div>
</div>
</div>
</div>
        </p>

        <style>
.feedback--answer {
    display: inline-block;
}

.feedback--answer-no {
    margin-left: 1em;
}

.feedback--response {
    display: none;
    margin-top: 1em;
}

.feedback--response__visible {
    display: block;
}
</style>

<div class="d-print-none">
    <h2 class="feedback--title">Feedback</h2>
    <p class="feedback--question">Was this page helpful?</p>
    <button class="feedback--answer feedback--answer-yes">Yes</button>
    <button class="feedback--answer feedback--answer-no">No</button>
    <p class="feedback--response feedback--response-yes">
        Glad to hear it! Please <a href="https://github.com/rlemaitre/pillars/issues/new?title=Docs%3A+Feedback+for+%27Configuration%27%20%F0%9F%91%8D&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:user-guide/20_features/10_configuration.adoc">tell us
    how we can improve</a>.
    </p>
    <p class="feedback--response feedback--response-no">
        Sorry to hear that. Please <a href="https://github.com/rlemaitre/pillars/issues/new?title=Docs%3A+Feedback+for+%27Configuration%27%20%F0%9F%91%8E&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:user-guide/20_features/10_configuration.adoc">tell
    us how we can improve</a>.
    </p>
</div>
<script>
    const yesButton = document.querySelector('.feedback--answer-yes');
    const noButton = document.querySelector('.feedback--answer-no');
    const yesResponse = document.querySelector('.feedback--response-yes');
    const noResponse = document.querySelector('.feedback--response-no');
    const disableButtons = () => {
        yesButton.disabled = true;
        noButton.disabled = true;
    };
    const sendFeedback = (value) => {
        if (typeof ga !== 'function') return;
        const args = {
            command: 'send',
            hitType: 'event',
            category: 'Helpful',
            action: 'click',
            label: window.location.pathname,
            value: value
        };
        ga(args.command, args.hitType, args.category, args.action, args.label, args.value);
    };
    yesButton.addEventListener('click', () => {
        yesResponse.classList.add('feedback--response__visible');
        disableButtons();
        sendFeedback(1);
    });
    noButton.addEventListener('click', () => {
        noResponse.classList.add('feedback--response__visible');
        disableButtons();
        sendFeedback(0);
    });
</script>


        <br>

        <!--div class="text-muted mt-5 pt-3 border-top">Last modified July 3, 2019: <a
                href="https://github.com/google/docsy-example/commit/d6aa89c8b24089d7e6741030864eff209465e896">Added
            links to user guide repo (d6aa89c)</a>
        </div-->
    </div>


    <script src="https://giscus.app/client.js"
            data-repo="rlemaitre/pillars"
            data-repo-id="R_kgDOK-Le0g"
            data-category="Comments"
            data-category-id="DIC_kwDOK-Le0s4Ccs4S"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="0"
            data-input-position="top"
            data-theme="light"
            data-lang="en"
            data-loading="lazy"
            crossorigin="anonymous"
            async>
    </script>
	</article>
	<aside class="doc__nav pop-out">
		
<div class="right__nav">

        <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_configuration">Configuration</a>
<ul class="sectlevel2">
<li><a href="#_pillars_configuration">Pillars Configuration</a></li>
<li><a href="#_application_configuration">Application Configuration</a></li>
</ul>
</li>
</ul>
</div>


    <ul>

        <li>
            <a href="https://github.com/rlemaitre/pillars/edit/main/docs/user-guide/20_features/10_configuration.adoc" target="_blank"><i class="fa fa-edit fa-fw"></i> Improve this doc</a>
        </li>


        <li>
            <a href="https://github.com/rlemaitre/pillars/issues/new?title=Docs%3A+Feedback+for+%27Configuration%27&body=%0A%0A%5BEnter%20feedback%20here%5D%0A%0A%0A---%0A%23page:%20https://github.com/rlemaitre/pillars/edit/main/docs/user-guide/20_features/10_configuration.adoc%0A%23branch:%20main" target="_blank">
                <i class="fa fa-github"></i> Create an issue
            </a>
        </li>

    </ul>
</div>

	</aside>
</div>
<footer class="footer">
    <div class="row">
        
        <a href="https://github.com/rlemaitre/pillars" rel="noopener noreferrer" title="Twitter"><i class="fa fa-github"></i></a>
        
        
        <a href="https://twitter.com/rlemaitre" rel="noopener noreferrer" title="Twitter"><i class="fa fa-twitter"></i></a>
        
        
        
        
        <a href="mailto:mailto:pillars@rlemaitre.com" rel="noopener noreferrer" target="_blank" title="Email"><i class="fa fa-envelope"></i></a>
        
    </div>
    <div class="row">built with <a href="https://doctoolchain.org">docToolchain</a> and <a href="https://jbake.org">jBake</a> <br /> theme: Custom based on <a href="https://github.com/amiechen/codrops-scribbler/">Scribbler</a></small></div>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/dockerfile.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/gradle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/scala.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/xml.min.js"></script>
<script>hljs.highlightAll();</script>
<script src="../../js/scribbler.js"></script>

</body>
</html>
